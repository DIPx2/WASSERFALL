"""
Модуль рендеринга SQL-шаблонов с использованием движка Jinja2.
Преобразует текстовые шаблоны запросов в исполняемый SQL путём подстановки переменных окружения.
Обеспечивает строгую валидацию отсутствующих переменных для предотвращения ошибок выполнения.
"""
from jinja2 import Template, StrictUndefined


def render_sql(template_str: str, context: dict) -> str:
    """Сгенерировать итоговый SQL-запрос из шаблона путём подстановки переменных контекста.

    Аргументы:
        template_str: Исходный текст SQL-шаблона с синтаксисом Jinja2
        context: Словарь переменных для подстановки в шаблон

    Возвращает:
        Готовый SQL-запрос с заменёнными переменными

    Примечания:
        Использование StrictUndefined гарантирует обнаружение всех незаполненных
        переменных на этапе рендеринга, а не во время выполнения запроса к БД.
        Это предотвращает частичное выполнение команд с некорректными параметрами.
        Шаблонизатор не модифицирует SQL-синтаксис, только заменяет переменные.
    """
    template = Template(template_str, undefined=StrictUndefined)
    return template.render(**context)